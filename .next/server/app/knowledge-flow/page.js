(()=>{var e={};e.id=542,e.ids=[542],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5862:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>l.a,__next_app__:()=>x,originalPathname:()=>p,pages:()=>d,routeModule:()=>m,tree:()=>c});var n=t(482),a=t(9108),r=t(2563),l=t.n(r),i=t(8300),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);t.d(s,o);let c=["",{children:["knowledge-flow",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,4502)),"C:\\Users\\kobap\\Desktop\\MVP\\knowledge-graph\\app\\knowledge-flow\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,6440)),"C:\\Users\\kobap\\Desktop\\MVP\\knowledge-graph\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9361,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\kobap\\Desktop\\MVP\\knowledge-graph\\app\\knowledge-flow\\page.tsx"],p="/knowledge-flow/page",x={require:t,loadChunk:()=>Promise.resolve()},m=new n.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/knowledge-flow/page",pathname:"/knowledge-flow",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},8266:(e,s,t)=>{Promise.resolve().then(t.bind(t,420))},420:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>k});var n=t(5344),a=t(3729),r=t(6212),l=t(4038),i=t(1838),o=t(5700);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let c=(0,t(9224).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var d=t(2312),p=t(5299),x=t(9410),m=t(7273),u=t(6336),g=t(2434),h=t(4765),f=t(6614),w=t(9553),j=t(5092),v=t(2993);let y=({children:e})=>{let[s,t]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{t(!0)},[]),s?n.jsx(n.Fragment,{children:e}):null},N=(0,m.default)(async()=>{},{loadableGenerated:{modules:["C:\\Users\\kobap\\Desktop\\MVP\\knowledge-graph\\app\\knowledge-flow\\page.tsx -> @/components/knowledge-graph-view"]},ssr:!1,loading:()=>n.jsx("div",{className:"flex items-center justify-center h-[50vh]",children:n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})})});function k(){let{t:e}=(0,h.Z)(),{toast:s}=(0,j.pm)(),[t,m]=(0,a.useState)(!1),[k,b]=(0,a.useState)(!1),[P,E]=(0,a.useState)([]),[S,C]=(0,a.useState)([]),[D,A]=(0,a.useState)([]),[_,$]=(0,a.useState)(!0),[q,z]=(0,a.useState)(!1);(0,a.useEffect)(()=>{try{return}catch(e){console.error("Error in localStorage load effect:",e)}},[]);let M=(0,a.useCallback)(()=>{},[P]),Z=(0,a.useCallback)(()=>{},[S]),F=(0,a.useCallback)(()=>{},[D]);(0,a.useEffect)(()=>{M()},[M]),(0,a.useEffect)(()=>{Z()},[Z]),(0,a.useEffect)(()=>{F()},[F]),(0,a.useEffect)(()=>{let t=async()=>{if(P.length>=2){let t=P[P.length-1],n=P.slice(0,P.length-1),a=`以下の新しいノードと既存のノードの関連性を評価してください。関連性の強さを0から1の間で評価し、0.5以上の関連性があるノードのIDと関連性の強さをJSON形式で返してください。

新しいノード:
ID: ${t.id}
タイトル: ${t.title}
内容: ${t.content}
タグ: ${t.tags.join(", ")}

既存のノード:
${n.map(e=>`ID: ${e.id}
タイトル: ${e.title}
内容: ${e.content}
タグ: ${e.tags.join(", ")}
---`).join("\n")}

返答形式:
{
  "relationships": [
    {"source": "新しいノードID", "target": "関連ノードID", "value": 関連性の強さ(0.5から1の間の数値)},
    ...
  ]
}`;try{let t=await (0,v.oJ)(a),n=(0,v.qj)(t);console.log("Cleaned AI response:",n);let r=JSON.parse(n);if(r.relationships&&r.relationships.length>0){let t=r.relationships.map(e=>({source:e.source,target:e.target,value:e.value}));C(e=>[...e,...t]),s({title:e("relationshipsAnalyzed"),description:e("aiFoundRelationships").replace("{count}",t.length.toString()),duration:3e3})}}catch(e){console.error("Error analyzing relationships:",e)}}};P.length>1&&t()},[P.length,s,e]);let O=async t=>{let n=t.title,a=t.content,r=[...t.tags];if(n.length<10&&a.length>0){z(!0);try{let t=`以下の短いタイトルと内容から、より具体的で分かりやすいタイトル（20-30文字程度）を生成してください。日本語で返答してください。
タイトル: ${n}
内容: ${a}`;if(n=(await (0,v.oJ)(t)).trim(),0===r.length){let e=`以下の内容に最適なタグを3つ以内で提案してください。各タグは一単語で、スペースを含まないこと。配列形式で返してください。例: ["タグ1", "タグ2", "タグ3"]
タイトル: ${n}
内容: ${a}`,s=await (0,v.oJ)(e);try{let e=JSON.parse(s);Array.isArray(e)&&(r=e.map(e=>e.startsWith("#")?e:`#${e}`))}catch(e){console.error("タグの解析に失敗:",e)}}s({title:e("titleEnhanced"),description:e("aiEnhancedTitle"),duration:3e3})}catch(e){console.error("タイトル拡張エラー:",e)}finally{z(!1)}}let l={id:Date.now().toString(),title:n,content:a,tags:r,createdAt:new Date,updatedAt:new Date,position:{x:0,y:0},type:"text"};E(e=>[...e,l]),A(e=>[l,...e])},V=async()=>{b(!0)};return(0,a.useEffect)(()=>{let e=window.onerror,s=s=>s.message&&(s.message.includes("message channel closed")||s.message.includes("asynchronous response"))?(s.preventDefault(),s.stopPropagation(),!0):!!e&&e.apply(window,[s.message,s.filename,s.lineno,s.colno,s.error]);return window.addEventListener("error",s),()=>{window.removeEventListener("error",s)}},[]),(0,a.useEffect)(()=>{let e=window.onunhandledrejection,s=s=>s.reason&&"string"==typeof s.reason.message&&(s.reason.message.includes("message channel closed")||s.reason.message.includes("asynchronous response"))?(s.preventDefault(),!0):!!e&&e.apply(window,[s]);return window.addEventListener("unhandledrejection",s),()=>{window.removeEventListener("unhandledrejection",s)}},[]),(0,n.jsxs)("div",{className:"flex flex-col min-h-screen",children:[n.jsx(f.SiteHeader,{}),(0,n.jsxs)("main",{className:"flex-1 flex flex-col pt-16",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between p-4 border-b bg-background",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[n.jsx(r.z,{variant:"outline",size:"icon",onClick:()=>$(!_),children:n.jsx(l.Z,{className:"h-4 w-4"})}),n.jsx("h1",{className:"text-lg font-medium",children:e("knowledgeFlow")})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsxs)(r.z,{variant:"outline",size:"sm",className:"gap-1.5",onClick:()=>m(!0),children:[n.jsx(i.Z,{className:"h-4 w-4"}),e("addNode")]}),(0,n.jsxs)(r.z,{variant:"outline",size:"sm",className:"gap-1.5",onClick:V,children:[n.jsx(o.Z,{className:"h-4 w-4"}),e("askAi")]}),P.length>0&&(0,n.jsxs)(r.z,{variant:"outline",size:"sm",className:"gap-1.5 text-destructive hover:text-destructive",onClick:()=>{},children:[n.jsx(c,{className:"h-4 w-4"}),e("clearAll")]})]})]}),(0,n.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[_&&(0,n.jsxs)("div",{className:"w-64 border-r bg-muted/20 overflow-auto p-4",children:[n.jsx("h3",{className:"font-medium mb-3",children:e("recentlyAdded")}),n.jsx("div",{className:"space-y-2",children:D.length>0?D.map(e=>(0,n.jsxs)("div",{className:"bg-background rounded-md p-3 border node-card cursor-pointer hover:bg-muted/40",children:[n.jsx("h4",{className:"font-medium text-sm truncate",children:e.title}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1 truncate",children:e.content}),e.tags.length>0&&(0,n.jsxs)("div",{className:"flex flex-wrap gap-1 mt-2",children:[e.tags.slice(0,2).map((e,s)=>n.jsx("span",{className:"text-[10px] bg-primary/10 text-primary px-1.5 py-0.5 rounded",children:e},s)),e.tags.length>2&&(0,n.jsxs)("span",{className:"text-[10px] bg-muted text-muted-foreground px-1.5 py-0.5 rounded",children:["+",e.tags.length-2]})]})]},e.id)):n.jsx("div",{className:"text-sm text-muted-foreground",children:e("noNodesYet")})})]}),n.jsx("div",{className:"flex-1 overflow-auto p-2",children:n.jsx(y,{children:n.jsx(N,{nodes:P,recentNodes:D,links:S})})})]}),0===P.length&&n.jsx("section",{className:"container py-12",children:(0,n.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2 lg:gap-12 items-center",children:[(0,n.jsxs)("div",{children:[n.jsx("h2",{className:"text-3xl font-bold tracking-tighter sm:text-4xl",children:e("knowledgeFlow")}),n.jsx("p",{className:"mt-4 text-muted-foreground",children:e("knowledgeFlowDescription")}),(0,n.jsxs)("ul",{className:"mt-6 space-y-4",children:[(0,n.jsxs)("li",{className:"flex items-center",children:[n.jsx("div",{className:"mr-2 flex h-8 w-8 items-center justify-center rounded-full bg-primary/10",children:n.jsx(d.Z,{className:"h-4 w-4 text-primary"})}),n.jsx("span",{children:e("visualConnections")})]}),(0,n.jsxs)("li",{className:"flex items-center",children:[n.jsx("div",{className:"mr-2 flex h-8 w-8 items-center justify-center rounded-full bg-primary/10",children:n.jsx(d.Z,{className:"h-4 w-4 text-primary"})}),n.jsx("span",{children:e("tagsOrganize")})]}),(0,n.jsxs)("li",{className:"flex items-center",children:[n.jsx("div",{className:"mr-2 flex h-8 w-8 items-center justify-center rounded-full bg-primary/10",children:n.jsx(d.Z,{className:"h-4 w-4 text-primary"})}),n.jsx("span",{children:e("aiAssistance")})]})]}),n.jsx("div",{className:"mt-8",children:(0,n.jsxs)(r.z,{onClick:()=>m(!0),className:"gap-2",children:[e("addNode"),n.jsx(p.Z,{className:"h-4 w-4"})]})})]}),n.jsx("div",{className:"flex justify-center",children:n.jsx("div",{className:"relative h-[400px] w-full overflow-hidden rounded-xl border bg-background p-2",children:n.jsx(x.default,{src:"/images/knowledge-flow-sample.svg",alt:e("knowledgeFlowExample"),fill:!0,className:"object-contain"})})})]})})]}),n.jsx(w.SiteFooter,{}),n.jsx(u.P,{isOpen:t,onClose:()=>m(!1),onSave:O,isProcessing:q}),n.jsx(g.j,{isOpen:k,onClose:()=>b(!1),onSaveAsNode:(e,s)=>{let t={id:Date.now().toString(),title:e,content:s,tags:[],createdAt:new Date,updatedAt:new Date,position:{x:0,y:0},type:"text"};E(e=>[...e,t]),A(e=>[t,...e].slice(0,5)),b(!1)}})]})}},4502:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>r,__esModule:()=>a,default:()=>l});let n=(0,t(6843).createProxy)(String.raw`C:\Users\kobap\Desktop\MVP\knowledge-graph\app\knowledge-flow\page.tsx`),{__esModule:a,$$typeof:r}=n,l=n.default}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),n=s.X(0,[638,635,222,951,902,993,718],()=>t(5862));module.exports=n})();